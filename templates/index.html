<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KeyGen Hamster - Ramadan Edition ğŸŒ™</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Amiri', serif;
            background-color: #1a1a2e;
            color: #e0e0e0;
            padding: 20px;
            background-image: url('https://i.imgur.com/ZXBXqQk.png');
            background-repeat: no-repeat;
            background-size: cover;
            background-attachment: fixed;
        }
        .container {
            display: flex;
            justify-content: space-between;
            max-width: 1000px;
            margin: 0 auto;
        }
        .form-container {
            width: 48%;
            background-color: rgba(26, 26, 46, 0.8);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            margin-bottom: 20px;
            overflow: auto;
            transition: all 0.3s ease;
        }
        .form-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 25px rgba(255, 215, 0, 0.5);
        }
        .form-container h2 {
            margin-top: 0;
            margin-bottom: 20px;
            text-align: center;
            color: #ffd700;
            font-size: 24px;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
        }
        .form-container > * {
            margin-bottom: 15px;
        }
        input[type="file"],
        input[type="text"],
        textarea,
        select {
            width: calc(100% - 22px);
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ffd700;
            border-radius: 5px;
            box-sizing: border-box;
            background-color: rgba(255, 255, 255, 0.1);
            color: #e0e0e0;
        }
        select {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url('data:image/svg+xml;utf8,<svg fill="%23ffd700" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 4"><path d="M4 4L0 0h8z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 8px;
        }
        button {
            width: calc(100% - 22px);
            padding: 12px;
            background-color: #ffd700;
            color: #1a1a2e;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
            display: block;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        button:hover {
            background-color: #ffea00;
            transform: scale(1.05);
        }
        label {
            display: block;
            color: #ffd700;
            margin-bottom: 5px;
        }
        #jsonDataDisplay {
            white-space: pre-wrap;
            background-color: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border: 1px solid #ffd700;
            border-radius: 5px;
            margin-top: 15px;
            font-family: monospace;
            overflow-x: auto;
            max-height: 200px;
            color: #e0e0e0;
        }
        .json-key {
            color: #ff6b6b;
        }
        .json-string {
            color: #4ecdc4;
        }
        .json-boolean {
            color: #feca57;
        }
        @media screen and (min-width: 801px) {
            .container {
                gap: 20px;
            }
        }
        @media screen and (max-width: 800px) {
            .container {
                flex-direction: column;
                align-items: center;
            }
            .form-container {
                width: 95%;
                margin-bottom: 20px;
            }
            #jsonDataDisplay {
                width: 95%;
                margin: 0 auto;
            }
        }
        .loading {
            display: none;
            text-align: center;
            margin-top: 20px;
        }
        .loading-text {
            font-size: 18px;
            color: #ffd700;
            margin-bottom: 10px;
        }
        .spinner {
            border: 4px solid rgba(255, 215, 0, 0.3);
            border-radius: 50%;
            border-top: 4px solid #ffd700;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="form-container">
            <h2>Ù…ÙˆÙ„Ø¯ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ - Ù†Ø³Ø®Ø© Ø±Ù…Ø¶Ø§Ù† ğŸŒ™âœ¨</h2>
            <label for="appSelect">Ø§Ø®ØªØ± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚:</label>
            <select id="appSelect" onchange="updateConstants()">
                <option value="Bike">Bike Ride 3DğŸš´â€â™‚ï¸</option>
                <option value="Clone">My Clone ArmyğŸª</option>
                <option value="Chain">Chain Cube 2048ğŸ²</option>
                <option value="Train">Train MinerğŸš‚</option>
            </select>
            <button onclick="generateKeys()">Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ù‡Ø§Ù…Ø³ØªØ± ğŸ¹</button>
            <button onclick="copyKeys()">Ù†Ø³Ø® Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø© ğŸ“‹</button>
            <div class="loading">
                <div class="loading-text">Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±... ğŸ•Œ</div>
                <div class="spinner"></div>
            </div>
        </div>

        <div class="form-container">
            <h2>Ø§Ù„Ø·Ø±ÙÙŠØ© ğŸ’»</h2>
            <pre id="jsonDataDisplay" class="key-display"></pre>
        </div>
    </div>

    <script>
        const appConfigs = {
            Bike: {
                appToken: 'd28721be-fd2d-4b45-869e-9f253b554e50',
                promoId: '43e35910-c168-4634-ad4f-52fd764a843f'
            },
            Clone: {
                appToken: '74ee0b5b-775e-4bee-974f-63e7f4d5bacb',
                promoId: 'fe693b26-b342-4159-8808-15e3ff7f8767'
            },
            Chain: {
                appToken: 'd1690a07-3780-4068-810f-9b5bbf2931b2',
                promoId: 'b4170868-cef0-424f-8eb9-be0622e8e8e3'
            },
            Train: {
                appToken: '82647f43-3f87-402d-88dd-09a90025313f',
                promoId: 'c4480ac7-e178-4973-8061-9ed5b2e17954'
            }
        };

        let APP_TOKEN = appConfigs.Bike.appToken;
        let PROMO_ID = appConfigs.Bike.promoId;
        const DEBUG_MODE = false;
        const EVENTS_DELAY = DEBUG_MODE ? 350 : 20000;
        const NUM_KEYS_TO_GENERATE = 4;
        let USER_ID = 'test_id';
        let USER = 'test_user';
        let HASH = 'test_hash';
        let generatedKeys = [];
        
        function updateConstants() {
            const selectedApp = document.getElementById('appSelect').value;
            APP_TOKEN = appConfigs[selectedApp].appToken;
            PROMO_ID = appConfigs[selectedApp].promoId;
        }

        function generateClientId() {
            const timestamp = Date.now();
            const randomNumbers = Array.from({ length: 19 }, () => Math.floor(Math.random() * 10)).join('');
            return `${timestamp}-${randomNumbers}`;
        }

        function generateDeviceId() {
            const baseDeviceId = '00000000000-0000000000000000000';
            const randomDigits = Array.from({ length: 5 }, () => Math.floor(Math.random() * 10)).join('');
            let deviceIdArray = baseDeviceId.split('');
            for (let i = 0; i < randomDigits.length; i++) {
                const randomIndex = Math.floor(Math.random() * deviceIdArray.length);
                deviceIdArray[randomIndex] = randomDigits[i];
            }
            return deviceIdArray.join('');
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        async function commitKey(key) {
            const keyData = {
                id: USER_ID,
                user: USER,
                hash: HASH,
                key: key
            };
            const keyDataEncoded = btoa(JSON.stringify(keyData));
            const url = DEBUG_MODE ?
                `http://localhost:8080/key?v=${keyDataEncoded}` :
                `http://localhost:8080/key?v=${keyDataEncoded}`;
        
            try {
                const response = await fetch(url, { method: 'POST' });
                return await response.json();
            } catch (error) {
                console.error('Error committing key:', error);
                return { status: 'error' };
            }
        }

        async function login(clientId) {
            if (DEBUG_MODE) {
                return `${APP_TOKEN}:deviceid:${deviceId}:${Date.now()}`;
            }
        
            try {
                const response = await fetch('https://api.gamepromo.io/promo/login-client', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        appToken: APP_TOKEN,
                        clientId: clientId,
                        clientOrigin: 'deviceid'
                    })
                });
                const data = await response.json();
                return data.clientToken;
            } catch (error) {
                console.error('Error logging in:', error);
                return null;
            }
        }

        async function emulateProgress(clientToken) {
            const eventUrl = 'https://api.gamepromo.io/promo/register-event';
            const headers = {
                'Authorization': `Bearer ${clientToken}`,
                'Content-Type': 'application/json'
            };
            const eventId = generateClientId();
            const eventData = {
                promoId: PROMO_ID,  
                eventId: eventId,
                eventOrigin: 'undefined'
            };

            let eventResponse;
            let eventJson;

            do {
                try {
                    eventResponse = await fetch(eventUrl, {
                        method: 'POST',
                        headers: headers,
                        body: JSON.stringify(eventData)
                    });

                    if (!eventResponse.ok) {
                        throw new Error(`Error: ${eventResponse.statusText}`);
                    }

                    eventJson = await eventResponse.json();

                    if (eventJson.hasCode) {
                        return true; // Successfully received the code
                    }

                    // Wait for 30 seconds before trying again
                    await sleep(30000);

                } catch (error) {
                    console.error('Error during progress emulation:', error);
                    return false; // Exit if an error occurs
                }
            } while (!eventJson.hasCode);

            return false;
        }

        async function generateKey(clientToken) {
            if (DEBUG_MODE) {
                return Math.random() < 0.5 ? 'PROMO-3YD-5ZA6-3VJA-Y77' : '';
            }
            try {
                const response = await fetch('https://api.gamepromo.io/promo/create-code', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${clientToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ promoId: PROMO_ID })
                });
                const data = await response.json();
                return data.promoCode;
            } catch (error) {
                console.error('Error generating key:', error);
                return null;
            }
        }
        
        async function generateSingleKey() {
            const clientId = generateClientId();
            const clientToken = await login(clientId);
        
            if (!clientToken) {
                appendToDisplay('ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„. ØªØ®Ø·ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙØªØ§Ø­. âŒ');
                return null;
            }
        
            appendToDisplay('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø§Ù†ØªØ¸Ø± Ø¨ÙŠÙ†Ù…Ø§ ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙØ§ØªÙŠØ­... ğŸ”‘');
        
            for (let j = 0; j < 7; j++) {
                if (await emulateProgress(clientToken)) {
                    break;
                }
                await sleep(EVENTS_DELAY);
            }
        
            const key = await generateKey(clientToken);
            if (key) {
                appendToDisplay(`ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙØªØ§Ø­: ${key} ğŸ‰`);
        
                if (USER_ID) {
                    const result = await commitKey(key);
                    if (result.status === 'ok') {
                        appendToDisplay(`Ø§Ù„Ù†Ù‚Ø§Ø·: ${result.points} ğŸ†`);
                        return key;
                    } else {
                        appendToDisplay('Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ§Ù„ÙŠ... ğŸ”„');
                        return null;
                    }
                } else {
                    return key;
                }
            } else {
                appendToDisplay('Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ§Ù„ÙŠ... ğŸ”„');
                return null;
            }
        }

        async function findValidKeys(numKeys) {
            const keyDisplay = document.getElementById('jsonDataDisplay');
            keyDisplay.style.display = "block";
            keyDisplay.textContent = ''; // Clear previous content
        
            const keyPromises = Array.from({ length: numKeys }, () => generateSingleKey());
            const keys = await Promise.all(keyPromises);
        
            const validKeys = keys.filter(key => key !== null);
            generatedKeys = validKeys.slice(-4); // Keep the last 4
if (validKeys.length > 0) {
                appendToDisplay(`Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØµØ§Ù„Ø­Ø©: ${validKeys.join(', ')} ğŸ”‘`);
            } else {
                appendToDisplay('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…ÙØ§ØªÙŠØ­ ØµØ§Ù„Ø­Ø©. ğŸ˜•');
            }
        }

        function appendToDisplay(text) {
            const keyDisplay = document.getElementById('jsonDataDisplay');
            keyDisplay.textContent += text + '\n';
            keyDisplay.scrollTop = keyDisplay.scrollHeight; // Auto-scroll to bottom
        }
        
        async function generateKeys() {
            const loadingDiv = document.querySelector('.loading');
            const keyDisplay = document.getElementById('jsonDataDisplay');
            loadingDiv.style.display = 'block';
            keyDisplay.textContent = '';
            
            try {
                await findValidKeys(NUM_KEYS_TO_GENERATE);
            } finally {
                loadingDiv.style.display = 'none';
            }
        }
        
        function copyKeys() {
            const keyDisplay = document.getElementById('jsonDataDisplay').textContent;
            const keyPattern = /ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙØªØ§Ø­:\s([A-Za-z0-9\-]+)/g;
            const keys = [];
            let match;
            while ((match = keyPattern.exec(keyDisplay)) !== null) {
                keys.push(match[1]);
            }
            if (keys.length > 0) {
                const keysText = keys.join('\n');
                navigator.clipboard.writeText(keysText).then(() => {
                    alert('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©:\n' + keysText + ' ğŸ“‹âœ…');
                }).catch(err => {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ù…ÙØ§ØªÙŠØ­:', err);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù†Ø³Ø® Ø§Ù„Ù…ÙØ§ØªÙŠØ­. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰. âŒ');
                });
            } else {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙØ§ØªÙŠØ­ Ù„Ù„Ù†Ø³Ø®. ğŸš«');
            }
        }
    </script>
</body>
</html>
